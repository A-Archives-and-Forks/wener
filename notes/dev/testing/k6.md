---
title: k6
---

# k6

- [grafana/k6](https://github.com/grafana/k6)
  - AGPL-3.0, Golang

```bash
brew install k6
# https://github.com/grafana/k6/releases
curl -LO https://github.com/grafana/k6/releases/download/v0.45.0/k6-v0.45.0-linux-amd64.tar.gz
tar zxvf k6-v0.45.0-linux-amd64.tar.gz --strip-components 1
./k6

k6 run script.js
```

```js
import { check, sleep } from 'k6';
import http from 'k6/http';

export const options = {
  // 单个
  vus: 10,
  duration: '30s',
  // or 多个场景
  // stages: [
  //   { duration: '30s', target: 20 },
  //   { duration: '1m30s', target: 10 },
  //   { duration: '20s', target: 0 },
  // ],
  // 目标，SLO
  thresholds: {
    // Assert that 99% of requests finish within 3000ms.
    http_req_duration: ['p(99) < 3000'],
  },
};

export default function () {
  const res = http.get('https://wener.me');
  check(res, { 'status was 200': (r) => r.status == 200 });
  sleep(1);
}
```

- virtual users (VUs)
- `__ENV`

```js
// 1. init code

export function setup() {
  // 2. setup code
  // Set up data for processing, share data among VUs
  // e.g. Call API to start test environment
  return {};
}

// data 为 setup 返回结果
export default function (data) {
  // 3. VU code
}

// data 为 setup 返回结果
export function teardown(data) {
  // 4. teardown code
  // Process result of setup code, stop test environment
}

// 通过配置 scenarios.*.exec 来指定执行
export function webtest() {}
```

- handleSummary
